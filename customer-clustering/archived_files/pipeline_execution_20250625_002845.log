2025-06-25 00:28:45,868 - INFO - 4185141521 - Step 'Data Analysis' completed in 0.17 seconds
2025-06-25 00:28:45,878 - INFO - 4185141521 - Starting: Feature Engineering and Silver Layer Creation
2025-06-25 00:28:46,841 - INFO - 4185141521 - Step 'Feature Engineering and Silver Layer Creation' failed in 0.96 seconds
2025-06-25 00:28:46,842 - ERROR - 4185141521 - Subprocess failed: Command '['c:\\Code\\Local Code\\URBN\\RETRO_hack_25\\.venv\\Scripts\\python.exe', 'create_features.py']' returned non-zero exit status 1.
2025-06-25 00:28:46,842 - ERROR - 4185141521 - STDOUT: 
2025-06-25 00:28:46,843 - ERROR - 4185141521 - STDERR: 2025-06-25 00:28:46,213 - INFO - Starting feature creation pipeline...
2025-06-25 00:28:46,224 - INFO - Connected to customer clustering database
2025-06-25 00:28:46,225 - INFO - Bronze layer contains 3,635,436 records
2025-06-25 00:28:46,225 - INFO - Starting comprehensive feature creation...
2025-06-25 00:28:46,257 - INFO - Processing features for 14999 customers in batches of 50000
2025-06-25 00:28:46,257 - INFO - Dataset small enough to process without batching
2025-06-25 00:28:46,257 - INFO - Creating basic volume metrics...
2025-06-25 00:28:46,257 - INFO - Creating basic volume metrics...
2025-06-25 00:28:46,509 - WARNING - avg_order_size: 205 values above warning threshold 10
2025-06-25 00:28:46,516 - INFO - Feature 'basic_volume_metrics' completed in 0.25s, 14999 records processed
2025-06-25 00:28:46,516 - INFO - Feature 'basic_volume_metrics' completed in 0.25s, 14999 records processed
2025-06-25 00:28:46,516 - INFO - Creating return behavior patterns...
2025-06-25 00:28:46,516 - INFO - Creating return behavior patterns...
2025-06-25 00:28:46,762 - WARNING - return_intensity: 2221 values outside expected range [0, 1]
2025-06-25 00:28:46,763 - WARNING - return_product_variety: 4553 values above warning threshold 25
2025-06-25 00:28:46,763 - WARNING - avg_returns_per_order: 17 values above warning threshold 8
2025-06-25 00:28:46,768 - INFO - Feature 'return_behavior_patterns' completed in 0.25s, 14999 records processed
2025-06-25 00:28:46,768 - INFO - Feature 'return_behavior_patterns' completed in 0.25s, 14999 records processed
2025-06-25 00:28:46,768 - INFO - Creating temporal patterns...
2025-06-25 00:28:46,768 - INFO - Creating temporal patterns...
2025-06-25 00:28:46,769 - ERROR - Feature creation failed: Binder Error: Cannot compare values of type INTERVAL and type INTEGER_LITERAL - an explicit cast is required

LINE 23:                 WHEN customer_lifetime_days <= 90 THEN 'New'
                                                     ^
2025-06-25 00:28:46,769 - ERROR - Feature creation pipeline failed: Binder Error: Cannot compare values of type INTERVAL and type INTEGER_LITERAL - an explicit cast is required

LINE 23:                 WHEN customer_lifetime_days <= 90 THEN 'New'
                                                     ^
2025-06-25 00:28:46,770 - ERROR - Traceback (most recent call last):
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\create_features.py", line 387, in main
    features = create_all_features(conn, run_tests=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\features.py", line 864, in create_all_features
    features['temporal'] = create_temporal_patterns(conn)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\features.py", line 322, in create_temporal_patterns
    result = conn.execute(query).fetchdf()
             ^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.BinderException: Binder Error: Cannot compare values of type INTERVAL and type INTEGER_LITERAL - an explicit cast is required

LINE 23:                 WHEN customer_lifetime_days <= 90 THEN 'New'
                                                     ^


2025-06-25 00:31:00,369 - INFO - 4185141521 - Starting: Feature Engineering and Silver Layer Creation
2025-06-25 00:31:01,367 - INFO - 4185141521 - Step 'Feature Engineering and Silver Layer Creation' failed in 1.00 seconds
2025-06-25 00:31:01,367 - ERROR - 4185141521 - Subprocess failed: Command '['c:\\Code\\Local Code\\URBN\\RETRO_hack_25\\.venv\\Scripts\\python.exe', 'create_features.py']' returned non-zero exit status 1.
2025-06-25 00:31:01,368 - ERROR - 4185141521 - STDOUT: 
2025-06-25 00:31:01,368 - ERROR - 4185141521 - STDERR: 2025-06-25 00:31:00,729 - INFO - Starting feature creation pipeline...
2025-06-25 00:31:00,745 - INFO - Connected to customer clustering database
2025-06-25 00:31:00,746 - INFO - Bronze layer contains 3,635,436 records
2025-06-25 00:31:00,746 - INFO - Starting comprehensive feature creation...
2025-06-25 00:31:00,779 - INFO - Processing features for 14999 customers in batches of 50000
2025-06-25 00:31:00,779 - INFO - Dataset small enough to process without batching
2025-06-25 00:31:00,779 - INFO - Creating basic volume metrics...
2025-06-25 00:31:00,779 - INFO - Creating basic volume metrics...
2025-06-25 00:31:01,060 - WARNING - avg_order_size: 205 values above warning threshold 10
2025-06-25 00:31:01,068 - INFO - Feature 'basic_volume_metrics' completed in 0.28s, 14999 records processed
2025-06-25 00:31:01,068 - INFO - Feature 'basic_volume_metrics' completed in 0.28s, 14999 records processed
2025-06-25 00:31:01,069 - INFO - Creating return behavior patterns...
2025-06-25 00:31:01,069 - INFO - Creating return behavior patterns...
2025-06-25 00:31:01,257 - WARNING - return_intensity: 2221 values outside expected range [0, 1]
2025-06-25 00:31:01,257 - WARNING - return_product_variety: 4553 values above warning threshold 25
2025-06-25 00:31:01,257 - WARNING - avg_returns_per_order: 17 values above warning threshold 8
2025-06-25 00:31:01,261 - INFO - Feature 'return_behavior_patterns' completed in 0.19s, 14999 records processed
2025-06-25 00:31:01,261 - INFO - Feature 'return_behavior_patterns' completed in 0.19s, 14999 records processed
2025-06-25 00:31:01,261 - INFO - Creating temporal patterns...
2025-06-25 00:31:01,261 - INFO - Creating temporal patterns...
2025-06-25 00:31:01,292 - ERROR - Feature creation failed: Conversion Error: Unimplemented type for cast (INTERVAL -> DOUBLE)

LINE 14:             avg(CAST(return_date - order_date AS DOUBLE)) as avg_days_to_re...
                         ^
2025-06-25 00:31:01,292 - ERROR - Feature creation pipeline failed: Conversion Error: Unimplemented type for cast (INTERVAL -> DOUBLE)

LINE 14:             avg(CAST(return_date - order_date AS DOUBLE)) as avg_days_to_re...
                         ^
2025-06-25 00:31:01,293 - ERROR - Traceback (most recent call last):
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\create_features.py", line 387, in main
    features = create_all_features(conn, run_tests=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\features.py", line 864, in create_all_features
    features['temporal'] = create_temporal_patterns(conn)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\features.py", line 322, in create_temporal_patterns
    result = conn.execute(query).fetchdf()
             ^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.ConversionException: Conversion Error: Unimplemented type for cast (INTERVAL -> DOUBLE)

LINE 14:             avg(CAST(return_date - order_date AS DOUBLE)) as avg_days_to_re...
                         ^


2025-06-25 00:33:25,245 - INFO - 4185141521 - Starting: Feature Engineering and Silver Layer Creation
2025-06-25 00:33:26,319 - INFO - 4185141521 - Step 'Feature Engineering and Silver Layer Creation' failed in 1.07 seconds
2025-06-25 00:33:26,320 - ERROR - 4185141521 - Subprocess failed: Command '['c:\\Code\\Local Code\\URBN\\RETRO_hack_25\\.venv\\Scripts\\python.exe', 'create_features.py']' returned non-zero exit status 1.
2025-06-25 00:33:26,320 - ERROR - 4185141521 - STDOUT: 
2025-06-25 00:33:26,321 - ERROR - 4185141521 - STDERR: 2025-06-25 00:33:25,600 - INFO - Starting feature creation pipeline...
2025-06-25 00:33:25,617 - INFO - Connected to customer clustering database
2025-06-25 00:33:25,618 - INFO - Bronze layer contains 3,635,436 records
2025-06-25 00:33:25,618 - INFO - Starting comprehensive feature creation...
2025-06-25 00:33:25,649 - INFO - Processing features for 14999 customers in batches of 50000
2025-06-25 00:33:25,649 - INFO - Dataset small enough to process without batching
2025-06-25 00:33:25,649 - INFO - Creating basic volume metrics...
2025-06-25 00:33:25,649 - INFO - Creating basic volume metrics...
2025-06-25 00:33:25,946 - WARNING - avg_order_size: 205 values above warning threshold 10
2025-06-25 00:33:25,953 - INFO - Feature 'basic_volume_metrics' completed in 0.30s, 14999 records processed
2025-06-25 00:33:25,953 - INFO - Feature 'basic_volume_metrics' completed in 0.30s, 14999 records processed
2025-06-25 00:33:25,953 - INFO - Creating return behavior patterns...
2025-06-25 00:33:25,953 - INFO - Creating return behavior patterns...
2025-06-25 00:33:26,213 - WARNING - return_intensity: 2221 values outside expected range [0, 1]
2025-06-25 00:33:26,213 - WARNING - return_product_variety: 4553 values above warning threshold 25
2025-06-25 00:33:26,213 - WARNING - avg_returns_per_order: 17 values above warning threshold 8
2025-06-25 00:33:26,217 - INFO - Feature 'return_behavior_patterns' completed in 0.26s, 14999 records processed
2025-06-25 00:33:26,217 - INFO - Feature 'return_behavior_patterns' completed in 0.26s, 14999 records processed
2025-06-25 00:33:26,217 - INFO - Creating temporal patterns...
2025-06-25 00:33:26,217 - INFO - Creating temporal patterns...
2025-06-25 00:33:26,245 - ERROR - Feature creation failed: Conversion Error: Unimplemented type for cast (INTERVAL -> INTEGER)

LINE 14:             avg(CAST(return_date - order_date AS INTEGER)) as avg_days_to_r...
                         ^
2025-06-25 00:33:26,245 - ERROR - Feature creation pipeline failed: Conversion Error: Unimplemented type for cast (INTERVAL -> INTEGER)

LINE 14:             avg(CAST(return_date - order_date AS INTEGER)) as avg_days_to_r...
                         ^
2025-06-25 00:33:26,247 - ERROR - Traceback (most recent call last):
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\create_features.py", line 387, in main
    features = create_all_features(conn, run_tests=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\features.py", line 864, in create_all_features
    features['temporal'] = create_temporal_patterns(conn)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\features.py", line 322, in create_temporal_patterns
    result = conn.execute(query).fetchdf()
             ^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.ConversionException: Conversion Error: Unimplemented type for cast (INTERVAL -> INTEGER)

LINE 14:             avg(CAST(return_date - order_date AS INTEGER)) as avg_days_to_r...
                         ^


2025-06-25 00:37:22,910 - INFO - 4185141521 - Starting: Feature Engineering and Silver Layer Creation
2025-06-25 00:38:07,276 - INFO - 4185141521 - Step 'Feature Engineering and Silver Layer Creation' failed in 44.37 seconds
2025-06-25 00:38:07,276 - ERROR - 4185141521 - Subprocess failed: Command '['c:\\Code\\Local Code\\URBN\\RETRO_hack_25\\.venv\\Scripts\\python.exe', 'create_features.py']' returned non-zero exit status 1.
2025-06-25 00:38:07,276 - ERROR - 4185141521 - STDOUT: None
2025-06-25 00:38:07,277 - ERROR - 4185141521 - STDERR: 2025-06-25 00:37:23,247 - INFO - Starting feature creation pipeline...
2025-06-25 00:37:23,266 - INFO - Connected to customer clustering database
2025-06-25 00:37:23,267 - INFO - Bronze layer contains 3,635,436 records
2025-06-25 00:37:23,267 - INFO - Starting comprehensive feature creation...
2025-06-25 00:37:23,296 - INFO - Processing features for 14999 customers in batches of 50000
2025-06-25 00:37:23,296 - INFO - Dataset small enough to process without batching
2025-06-25 00:37:23,296 - INFO - Creating basic volume metrics...
2025-06-25 00:37:23,296 - INFO - Creating basic volume metrics...
2025-06-25 00:37:23,552 - WARNING - avg_order_size: 205 values above warning threshold 10
2025-06-25 00:37:23,559 - INFO - Feature 'basic_volume_metrics' completed in 0.26s, 14999 records processed
2025-06-25 00:37:23,559 - INFO - Feature 'basic_volume_metrics' completed in 0.26s, 14999 records processed
2025-06-25 00:37:23,559 - INFO - Creating return behavior patterns...
2025-06-25 00:37:23,559 - INFO - Creating return behavior patterns...
2025-06-25 00:37:23,748 - WARNING - return_intensity: 2221 values outside expected range [0, 1]
2025-06-25 00:37:23,748 - WARNING - return_product_variety: 4553 values above warning threshold 25
2025-06-25 00:37:23,748 - WARNING - avg_returns_per_order: 17 values above warning threshold 8
2025-06-25 00:37:23,752 - INFO - Feature 'return_behavior_patterns' completed in 0.19s, 14999 records processed
2025-06-25 00:37:23,752 - INFO - Feature 'return_behavior_patterns' completed in 0.19s, 14999 records processed
2025-06-25 00:37:23,753 - INFO - Creating temporal patterns...
2025-06-25 00:37:23,753 - INFO - Creating temporal patterns...
2025-06-25 00:37:23,808 - WARNING - avg_days_to_return: 439 values above warning threshold 60
2025-06-25 00:37:23,808 - WARNING - return_timing_spread: 1032 values above warning threshold 45
2025-06-25 00:37:23,811 - INFO - Feature 'temporal_patterns' completed in 0.06s, 14999 records processed
2025-06-25 00:37:23,811 - INFO - Feature 'temporal_patterns' completed in 0.06s, 14999 records processed
2025-06-25 00:37:23,813 - INFO - Creating recency analysis...
2025-06-25 00:37:23,813 - INFO - Creating recency analysis...
2025-06-25 00:37:23,919 - INFO - Feature 'recency_analysis' completed in 0.10s, 14999 records processed
2025-06-25 00:37:23,919 - INFO - Feature 'recency_analysis' completed in 0.10s, 14999 records processed
2025-06-25 00:37:23,919 - INFO - Creating category intelligence...
2025-06-25 00:37:23,919 - INFO - Creating category intelligence features...
2025-06-25 00:37:24,140 - WARNING - category_diversity_score: 5999 values above warning threshold 1.5
2025-06-25 00:37:24,145 - INFO - Feature 'category_intelligence' completed in 0.22s, 14972 records processed
2025-06-25 00:37:24,145 - INFO - Feature 'category_intelligence' completed in 0.22s, 14972 records processed
2025-06-25 00:37:24,145 - INFO - Creating consecutive returns...
2025-06-25 00:37:24,765 - WARNING - consecutive_returns: 5692 values above warning threshold 6
2025-06-25 00:37:24,765 - WARNING - avg_consecutive_returns: 1247 values above warning threshold 3
2025-06-25 00:37:24,768 - INFO - Feature 'consecutive_returns' completed in 0.62s, 14999 records processed
2025-06-25 00:37:24,768 - INFO - Feature 'consecutive_returns' completed in 0.62s, 14999 records processed
2025-06-25 00:37:24,768 - INFO - Creating adjacency features...
2025-06-25 00:38:06,099 - INFO - Feature 'adjacency_features' completed in 41.33s, 14999 records processed
2025-06-25 00:38:06,099 - INFO - Feature 'adjacency_features' completed in 41.33s, 14999 records processed
2025-06-25 00:38:06,100 - INFO - Creating seasonal features...
2025-06-25 00:38:06,100 - INFO - Creating seasonal features...
2025-06-25 00:38:06,353 - INFO - Feature 'seasonal_features' completed in 0.25s, 14999 records processed
2025-06-25 00:38:06,353 - INFO - Feature 'seasonal_features' completed in 0.25s, 14999 records processed
2025-06-25 00:38:06,353 - INFO - Creating trend susceptibility...
2025-06-25 00:38:06,353 - INFO - Creating trend susceptibility features...
2025-06-25 00:38:06,819 - INFO - trend_product_category_return_rate: 1001 null values found
2025-06-25 00:38:06,824 - INFO - Feature 'trend_susceptibility' completed in 0.47s, 14999 records processed
2025-06-25 00:38:06,824 - INFO - Feature 'trend_susceptibility' completed in 0.47s, 14999 records processed
2025-06-25 00:38:06,824 - INFO - All features created successfully in 43.56 seconds
2025-06-25 00:38:06,824 - INFO - Merging feature dataframes...
2025-06-25 00:38:06,882 - INFO - Merged features: 14999 customers, 35 features
2025-06-25 00:38:06,882 - INFO - Adding metadata features...
2025-06-25 00:38:06,992 - INFO - Added metadata features. Final dataset: 14999 customers, 41 features
2025-06-25 00:38:06,993 - INFO - Validating silver layer data...
2025-06-25 00:38:06,995 - INFO - âœ… Silver layer data validation PASSED
2025-06-25 00:38:06,995 - INFO - Inserting data into silver_customer_features table...
2025-06-25 00:38:06,996 - INFO - Cleared existing silver layer data
2025-06-25 00:38:07,029 - ERROR - Failed to insert silver layer data: Binder Error: table silver_customer_features has 44 columns but 41 values were supplied
2025-06-25 00:38:07,029 - ERROR - Traceback (most recent call last):
  File "c:\Code\Local Code\URBN\RETRO_hack_25\customer-clustering\create_features.py", line 251, in insert_silver_layer_data
    conn.execute("INSERT INTO silver_customer_features SELECT * FROM chunk")
duckdb.duckdb.BinderException: Binder Error: table silver_customer_features has 44 columns but 41 values were supplied

2025-06-25 00:38:07,030 - ERROR - Failed to insert data into silver layer

2025-06-25 01:11:49,828 - INFO - 4185141521 - Starting: Feature Engineering and Silver Layer Creation
2025-06-25 01:12:40,430 - INFO - 4185141521 - Step 'Feature Engineering and Silver Layer Creation' completed in 50.60 seconds
2025-06-25 01:14:11,099 - INFO - 4185141521 - Starting: Cluster Preprocessing and Gold Layer Creation
2025-06-25 01:14:17,094 - INFO - 4185141521 - Step 'Cluster Preprocessing and Gold Layer Creation' failed in 6.00 seconds
2025-06-25 01:14:17,095 - ERROR - 4185141521 - Subprocess failed: Command '['c:\\Code\\Local Code\\URBN\\RETRO_hack_25\\.venv\\Scripts\\python.exe', 'cluster_preprocessing.py', '--scaling', 'robust', '--variance-threshold', '0.01', '--outlier-contamination', '0.05']' returned non-zero exit status 1.
2025-06-25 01:14:17,096 - ERROR - 4185141521 - STDOUT: 
2025-06-25 01:14:17,096 - ERROR - 4185141521 - STDERR: 2025-06-25 01:14:15,894 - INFO - Starting cluster preprocessing pipeline...
2025-06-25 01:14:15,894 - INFO - Parameters: scaling=robust, variance_threshold=0.01, contamination=0.05
2025-06-25 01:14:15,913 - INFO - Connected to customer clustering database
2025-06-25 01:14:15,913 - INFO - Silver layer contains 14,999 customer records
2025-06-25 01:14:15,913 - INFO - Initialized ClusterPreprocessor with robust scaling
2025-06-25 01:14:15,913 - INFO - Loading data from silver layer...
2025-06-25 01:14:15,928 - INFO - Loaded 14999 customers with 44 features
2025-06-25 01:14:15,928 - INFO - Selecting features for clustering...
2025-06-25 01:14:15,928 - INFO - Including category_diversity_score: 99.8% customers have data
2025-06-25 01:14:15,928 - INFO - Including category_loyalty_score: 100.0% customers have data
2025-06-25 01:14:15,930 - INFO - Including high_return_category_affinity: 99.8% customers have data
2025-06-25 01:14:15,930 - INFO - Including sku_adjacency_orders: 98.7% customers have data
2025-06-25 01:14:15,930 - INFO - Including sku_adjacency_returns: 64.3% customers have data
2025-06-25 01:14:15,930 - INFO - Including sku_adjacency_timing: 98.2% customers have data
2025-06-25 01:14:15,930 - INFO - Including sku_adjacency_return_timing: 62.6% customers have data
2025-06-25 01:14:15,930 - INFO - Including seasonal_susceptibility_orders: 85.9% customers have data
2025-06-25 01:14:15,930 - INFO - Including seasonal_susceptibility_returns: 80.9% customers have data
2025-06-25 01:14:15,930 - INFO - Including trend_product_category_order_rate: 99.6% customers have data
2025-06-25 01:14:15,930 - INFO - Including trend_product_category_return_rate: 92.9% customers have data
2025-06-25 01:14:15,932 - INFO - Selected 29 features for clustering:
2025-06-25 01:14:15,932 - INFO -   volume_metrics: 5 features
2025-06-25 01:14:15,932 - INFO -   return_behavior: 6 features
2025-06-25 01:14:15,932 - INFO -   temporal_patterns: 3 features
2025-06-25 01:14:15,932 - INFO -   recency_trends: 4 features
2025-06-25 01:14:15,932 - INFO -   category_intelligence: 3 features
2025-06-25 01:14:15,932 - INFO -   adjacency_patterns: 4 features
2025-06-25 01:14:15,932 - INFO -   seasonal_trends: 2 features
2025-06-25 01:14:15,932 - INFO -   trend_susceptibility: 2 features
2025-06-25 01:14:15,932 - INFO - Handling missing values...
2025-06-25 01:14:15,934 - INFO - Removing low variance features (threshold: 0.01)...
2025-06-25 01:14:15,936 - INFO - Removed 1 low variance features:
2025-06-25 01:14:15,936 - INFO -   category_loyalty_score: variance = 0.008292
2025-06-25 01:14:15,937 - INFO - Detecting outliers using Isolation Forest (contamination: 0.05)...
2025-06-25 01:14:16,210 - INFO - Detected 750 outliers (5.0%)
2025-06-25 01:14:16,211 - INFO - Outlier characteristics:
2025-06-25 01:14:16,211 - INFO -   Avg return rate: 0.393
2025-06-25 01:14:16,211 - INFO -   Avg order count: 420.0
2025-06-25 01:14:16,211 - INFO -   Avg lifetime days: 967
2025-06-25 01:14:16,212 - INFO - Scaling features using robust scaler...
2025-06-25 01:14:16,228 - INFO - Scaled 28 features
2025-06-25 01:14:16,228 - INFO - Creating gold layer dataset...
2025-06-25 01:14:16,228 - INFO - Calculating feature completeness scores...
2025-06-25 01:14:16,782 - INFO - Average feature completeness: 0.000
2025-06-25 01:14:16,792 - INFO - Gold layer dataset created: 14999 customers, 35 columns
2025-06-25 01:14:16,792 - INFO - Inserting data into gold_cluster_processed table...
2025-06-25 01:14:16,793 - INFO - Cleared existing gold layer data
2025-06-25 01:14:16,805 - ERROR - Failed to insert gold layer data: Binder Error: table gold_cluster_processed has 41 columns but 34 values were supplied
2025-06-25 01:14:16,805 - ERROR - Failed to insert data into gold layer

2025-06-25 01:19:00,320 - INFO - 4185141521 - Step 'Feature Analytics and Excel Export' completed in 0.89 seconds
2025-06-25 09:29:48,827 - INFO - 4185141521 - Starting: Cluster Preprocessing and Gold Layer Creation
2025-06-25 09:29:54,820 - INFO - 4185141521 - Step 'Cluster Preprocessing and Gold Layer Creation' failed in 5.99 seconds
2025-06-25 09:29:54,820 - ERROR - 4185141521 - Subprocess failed: Command '['c:\\Code\\Local Code\\URBN\\RETRO_hack_25\\.venv\\Scripts\\python.exe', 'cluster_preprocessing.py', '--scaling', 'robust', '--variance-threshold', '0.01', '--outlier-contamination', '0.05']' returned non-zero exit status 1.
2025-06-25 09:29:54,822 - ERROR - 4185141521 - STDOUT: 
2025-06-25 09:29:54,822 - ERROR - 4185141521 - STDERR: 2025-06-25 09:29:53,743 - INFO - Starting cluster preprocessing pipeline...
2025-06-25 09:29:53,743 - INFO - Parameters: scaling=robust, variance_threshold=0.01, contamination=0.05
2025-06-25 09:29:53,761 - INFO - Connected to customer clustering database
2025-06-25 09:29:53,762 - INFO - Silver layer contains 14,999 customer records
2025-06-25 09:29:53,762 - INFO - Initialized ClusterPreprocessor with robust scaling
2025-06-25 09:29:53,762 - INFO - Loading data from silver layer...
2025-06-25 09:29:53,783 - INFO - Loaded 14999 customers with 44 features
2025-06-25 09:29:53,783 - INFO - Selecting features for clustering...
2025-06-25 09:29:53,784 - INFO - Including category_diversity_score: 99.8% customers have data
2025-06-25 09:29:53,784 - INFO - Including category_loyalty_score: 100.0% customers have data
2025-06-25 09:29:53,784 - INFO - Including high_return_category_affinity: 99.8% customers have data
2025-06-25 09:29:53,784 - INFO - Including sku_adjacency_orders: 98.7% customers have data
2025-06-25 09:29:53,784 - INFO - Including sku_adjacency_returns: 64.3% customers have data
2025-06-25 09:29:53,784 - INFO - Including sku_adjacency_timing: 98.2% customers have data
2025-06-25 09:29:53,784 - INFO - Including sku_adjacency_return_timing: 62.6% customers have data
2025-06-25 09:29:53,784 - INFO - Including seasonal_susceptibility_orders: 85.9% customers have data
2025-06-25 09:29:53,784 - INFO - Including seasonal_susceptibility_returns: 80.9% customers have data
2025-06-25 09:29:53,785 - INFO - Including trend_product_category_order_rate: 99.6% customers have data
2025-06-25 09:29:53,785 - INFO - Including trend_product_category_return_rate: 92.9% customers have data
2025-06-25 09:29:53,786 - INFO - Selected 29 features for clustering:
2025-06-25 09:29:53,786 - INFO -   volume_metrics: 5 features
2025-06-25 09:29:53,786 - INFO -   return_behavior: 6 features
2025-06-25 09:29:53,786 - INFO -   temporal_patterns: 3 features
2025-06-25 09:29:53,786 - INFO -   recency_trends: 4 features
2025-06-25 09:29:53,786 - INFO -   category_intelligence: 3 features
2025-06-25 09:29:53,786 - INFO -   adjacency_patterns: 4 features
2025-06-25 09:29:53,786 - INFO -   seasonal_trends: 2 features
2025-06-25 09:29:53,786 - INFO -   trend_susceptibility: 2 features
2025-06-25 09:29:53,786 - INFO - Handling missing values...
2025-06-25 09:29:53,788 - INFO - Removing low variance features (threshold: 0.01)...
2025-06-25 09:29:53,790 - INFO - Removed 1 low variance features:
2025-06-25 09:29:53,790 - INFO -   category_loyalty_score: variance = 0.008292
2025-06-25 09:29:53,790 - INFO - Detecting outliers using Isolation Forest (contamination: 0.05)...
2025-06-25 09:29:54,059 - INFO - Detected 750 outliers (5.0%)
2025-06-25 09:29:54,060 - INFO - Outlier characteristics:
2025-06-25 09:29:54,060 - INFO -   Avg return rate: 0.393
2025-06-25 09:29:54,060 - INFO -   Avg order count: 420.0
2025-06-25 09:29:54,060 - INFO -   Avg lifetime days: 967
2025-06-25 09:29:54,061 - INFO - Scaling features using robust scaler...
2025-06-25 09:29:54,076 - INFO - Scaled 28 features
2025-06-25 09:29:54,077 - INFO - Creating gold layer dataset...
2025-06-25 09:29:54,077 - INFO - Calculating feature completeness scores...
2025-06-25 09:29:54,564 - INFO - Average feature completeness: 0.000
2025-06-25 09:29:54,575 - INFO - Gold layer dataset created: 14999 customers, 35 columns
2025-06-25 09:29:54,576 - INFO - Inserting data into gold_cluster_processed table...
2025-06-25 09:29:54,578 - INFO - Cleared existing gold layer data
2025-06-25 09:29:54,586 - ERROR - Failed to insert gold layer data: Binder Error: table gold_cluster_processed has 41 columns but 34 values were supplied
2025-06-25 09:29:54,586 - ERROR - Failed to insert data into gold layer

2025-06-25 09:36:08,630 - INFO - 4185141521 - Starting: Cluster Preprocessing and Gold Layer Creation
2025-06-25 09:36:11,203 - INFO - 4185141521 - Step 'Cluster Preprocessing and Gold Layer Creation' completed in 2.57 seconds
2025-06-25 09:37:11,648 - INFO - 4185141521 - Starting: Cluster Preprocessing and Gold Layer Creation
2025-06-25 09:37:14,368 - INFO - 4185141521 - Step 'Cluster Preprocessing and Gold Layer Creation' completed in 2.72 seconds
2025-06-25 09:37:41,571 - INFO - 4185141521 - Step 'Clustering' skipped
