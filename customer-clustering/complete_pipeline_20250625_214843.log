2025-06-25 21:48:43,853 - INFO - Starting complete pipeline
2025-06-25 21:48:43,874 - INFO - Connected to database: customer_clustering.db
2025-06-25 21:48:43,874 - INFO - Checking for duplicates in all layers
2025-06-25 21:48:43,971 - INFO - Bronze layer: 3635436 total rows, 3635436 unique primary keys, 0 duplicates
2025-06-25 21:48:43,974 - INFO - Silver layer: 14999 total rows, 14999 unique emails, 0 duplicates
2025-06-25 21:48:43,977 - INFO - Gold layer: 14999 total rows, 14999 unique emails, 0 duplicates
2025-06-25 21:48:43,977 - INFO - Importing data from ../data/random1_FINAL_SENT.csv
2025-06-25 21:48:43,978 - INFO - Bronze layer has 3635436 rows before import
2025-06-25 21:48:43,996 - INFO - Loading CSV into temporary table
2025-06-25 21:48:55,342 - INFO - Temporary table has 31 columns
2025-06-25 21:48:55,342 - INFO - Mapping columns and generating primary keys
2025-06-25 21:48:55,343 - INFO - Bronze layer has 24 columns: ['primary_key', 'sales_order_no', 'customer_emailid', 'order_date', 'sku', 'sales_qty', 'gross', 'return_qty', 'units_returned_flag', 'return_date', 'return_no', 'return_comment', 'orderlink', 'q_cls_id', 'q_sku_desc', 'q_gmm_id', 'q_sku_id', 'class_', 'division_', 'brand_', 'q_clr_dnum', 'q_clr_desc', 'vendor_style', 'size_']
2025-06-25 21:48:55,344 - INFO - Creating formatted table with all required columns
2025-06-25 21:48:58,537 - INFO - Inserting data into bronze layer
2025-06-25 21:49:24,126 - INFO - Added 2437247 new rows to bronze layer
2025-06-25 21:49:24,192 - INFO - Updating silver layer features
2025-06-25 21:49:24,257 - INFO - Found 623 unique product categories in bronze layer
2025-06-25 21:49:24,257 - INFO - Updating category_diversity_score
2025-06-25 21:49:24,562 - INFO - Identifying new customers to add to silver layer
2025-06-25 21:49:24,604 - INFO - Found 9 new customers to add to silver layer
2025-06-25 21:49:24,604 - INFO - Updating existing customers in silver layer
2025-06-25 21:49:24,613 - INFO - Updated 14999 existing customers in silver layer
2025-06-25 21:49:24,613 - INFO - Updating gold layer scaled features
2025-06-25 21:49:24,613 - INFO - Updating category_diversity_score_scaled in gold layer
2025-06-25 21:49:25,630 - INFO - Updated category_diversity_score_scaled for 14999 customers in gold layer
2025-06-25 21:49:25,630 - INFO - Checking for duplicates in all layers
2025-06-25 21:49:25,929 - INFO - Bronze layer: 6072683 total rows, 6072683 unique primary keys, 0 duplicates
2025-06-25 21:49:25,935 - INFO - Silver layer: 14999 total rows, 14999 unique emails, 0 duplicates
2025-06-25 21:49:25,939 - INFO - Gold layer: 14999 total rows, 14999 unique emails, 0 duplicates
2025-06-25 21:49:25,939 - INFO - Exporting silver and gold layers
2025-06-25 21:49:25,939 - INFO - Exporting silver layer to silver_customer_features_20250625_214843.csv
2025-06-25 21:49:26,269 - INFO - Exported 14999 rows to silver_customer_features_20250625_214843.csv
2025-06-25 21:49:26,269 - INFO - Exporting gold layer to gold_cluster_processed_20250625_214843.csv
2025-06-25 21:49:26,617 - INFO - Exported 14999 rows to gold_cluster_processed_20250625_214843.csv
2025-06-25 21:49:26,618 - INFO - Successfully exported silver and gold layers
2025-06-25 21:49:26,618 - INFO - Complete pipeline finished in 42.77 seconds
2025-06-25 21:49:26,736 - INFO - Database connection closed
