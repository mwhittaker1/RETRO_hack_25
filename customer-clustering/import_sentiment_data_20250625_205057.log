2025-06-25 20:50:57,455 - INFO - Starting sentiment data import and diversity score update
2025-06-25 20:50:57,470 - INFO - Connected to database: customer_clustering.db
2025-06-25 20:50:57,478 - INFO - Importing data from sentiment_and_raw/new_base_returns_sku_reasoncodes_sent.csv
2025-06-25 20:50:59,310 - INFO - Read 388410 rows from CSV file
2025-06-25 20:50:59,310 - INFO - Original columns: ['SALES_ORDER_NO', 'CUSTOMER_EMAILID', 'ORDER_DATE', 'SKU', 'SALES_QTY', 'GROSS', 'RETURN_QTY', 'UNITS_RETURNED_FLAG', 'RETURN_DATE', 'RETURN_NO', 'RETURN_COMMENT', 'RETURN_REASON', 'ORDERLINK', 'F_ID', 'F_NAME', 'Q_D2C_RTRN_REASONCODE_ID', 'Q_D2C_RET_REASON_NAME', 'Q_D2C_RET_REASON', 'Q_D2C_RET_REASON_GROUP_NAME0', 'Q_CLS_ID', 'Q_SKU_DESC', 'Q_GMM_ID', 'Q_SKU_ID', 'CLASS_', 'DIVISION_', 'BRAND_', 'Q_CLR_DNUM', 'Q_CLR_DESC', 'VENDOR_STYLE', 'SIZE_', 'SAMPLE_ID', 'SENTIMENT SCORE']
2025-06-25 20:50:59,312 - INFO - Mapped column SALES_ORDER_NO to sales_order_no
2025-06-25 20:50:59,319 - INFO - Mapped column CUSTOMER_EMAILID to customer_emailid
2025-06-25 20:50:59,321 - INFO - Mapped column ORDER_DATE to order_date
2025-06-25 20:50:59,324 - INFO - Mapped column SKU to sku
2025-06-25 20:50:59,325 - INFO - Mapped column SALES_QTY to sales_qty
2025-06-25 20:50:59,326 - INFO - Mapped column GROSS to gross
2025-06-25 20:50:59,327 - INFO - Mapped column RETURN_QTY to return_qty
2025-06-25 20:50:59,328 - INFO - Mapped column UNITS_RETURNED_FLAG to units_returned_flag
2025-06-25 20:50:59,329 - INFO - Mapped column RETURN_DATE to return_date
2025-06-25 20:50:59,331 - INFO - Mapped column RETURN_NO to return_no
2025-06-25 20:50:59,334 - INFO - Mapped column RETURN_COMMENT to return_comment
2025-06-25 20:50:59,335 - INFO - Mapped column ORDERLINK to orderlink
2025-06-25 20:50:59,337 - INFO - Mapped column Q_CLS_ID to q_cls_id
2025-06-25 20:50:59,339 - INFO - Mapped column Q_SKU_DESC to q_sku_desc
2025-06-25 20:50:59,341 - INFO - Mapped column Q_GMM_ID to q_gmm_id
2025-06-25 20:50:59,342 - INFO - Mapped column Q_SKU_ID to q_sku_id
2025-06-25 20:50:59,342 - INFO - Mapped column CLASS_ to class_
2025-06-25 20:50:59,343 - INFO - Mapped column DIVISION_ to division_
2025-06-25 20:50:59,345 - INFO - Mapped column BRAND_ to brand_
2025-06-25 20:50:59,346 - INFO - Mapped column Q_CLR_DNUM to q_clr_dnum
2025-06-25 20:50:59,347 - INFO - Mapped column Q_CLR_DESC to q_clr_desc
2025-06-25 20:50:59,348 - INFO - Mapped column VENDOR_STYLE to vendor_style
2025-06-25 20:50:59,351 - INFO - Mapped column SIZE_ to size_
2025-06-25 20:50:59,445 - INFO - Generated primary key column
2025-06-25 20:50:59,452 - INFO - Converted units_returned_flag to string
2025-06-25 20:50:59,677 - INFO - Prepared DataFrame with 388410 rows and 24 columns
2025-06-25 20:51:00,111 - INFO - Inserted 388410 rows into temporary table
2025-06-25 20:51:00,113 - INFO - Bronze layer has 3635436 rows before import
2025-06-25 20:51:00,204 - ERROR - Error inserting data: Conversion Error: invalid timestamp field format: "No", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column units_returned_flag
2025-06-25 20:51:00,224 - ERROR - Failed to import sentiment data
2025-06-25 20:51:00,278 - INFO - Database connection closed
